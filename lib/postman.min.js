(function(){var a,b,c,d,e,f,g,h,i,j;a={},g=function(a){return a.constructor===Array},i=function(a){return a.constructor===Function},h=function(a){return a.constructor===Date},b=function(b){return a[b]={subs:[],history:[]}},c=function(c,d){var e,f,h,i;a[c]||b(c),d||(d=[]),g(d)||(d=[d]),d={created:new Date,lastPublished:new Date,args:d},a[c].history.push(d),i=a[c].subs;for(f=0,h=i.length;f<h;f++)e=i[f],e.apply(this,d.args);return postman},j=function(c,d){var e,f,g,h;a[c]||b(c),a[c].subs.push(d),h=a[c].history;for(f=0,g=h.length;f<g;f++)e=h[f],d.apply(this,e.args);return postman},f=function(c,f){a[c]||b(c),f?(i(f)&&(a[c].history=e(f,a[c].history)),h(f)&&(a[c].history=d(f,a[c].history))):a[c].history=[];return postname.deliver("dropMessage."+c)},e=function(a,b){return b.reduce(a)},d=function(a,b){return b.reduce(function(b){return b.lastPublished<a})},this.postman={deliver:c,receive:j,dropMessages:f}}).call(this)