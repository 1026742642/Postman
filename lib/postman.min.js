(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;a=function(){function a(){var a,b;a=null,b=null,this.first=function(){return a},this.last=function(){return b},this.length=0,this.append=function(c){var d;if(!!c){d={data:c,next:null,prev:null},a?(b.next=d,d.prev=b,b=d):(a=d,b=d);return this.length++}},this.remove=function(b){if(!!b){b.prev?b.prev.next=b.next:(a=b.next,a&&(a.prev=null));return this.length--}}}return a}(),b={},k,h=function(a){return a.constructor===Array},j=function(a){return a.constructor===Function},i=function(a){return a.constructor===Date},c=function(c){return b[c]={subs:new a,history:new a}},d=function(a,d){var e;b[a]||c(a),d||(d=[]),h(d)||(d=[d]),d={created:new Date,lastPublished:new Date,args:d},b[a].history.append(d),e=b[a].subs.first();while(e)e.data.apply(this,d.args),e=e.next;return k},l=function(a,d,e){var f;b[a]||c(a),b[a].subs.append(d);if(!e){f=b[a].history.first();while(f)d.apply(this,f.data.args),f.data.lastPublished=new Date,f=f.next;return k}},m=function(d,e){var f,g;b[d]||c(d);if(!e)b[d].subs=new a;else{g=b[d].subs,f=g.first();while(f)f.data===e&&g.remove(f),f=f.next}return k},g=function(d,g){b[d]||c(d),g?(j(g)&&(b[d].history=f(g,b[d].history)),i(g)&&(b[d].history=e(g,b[d].history))):b[d].history=new a;return k.deliver("dropMessage."+d)},f=function(a,b){var c;c=b.first();while(c)a.apply(c.data)&&b.remove(c),c=c.next;return b},e=function(a,b){var c;c=b.first();while(c)c.data.created<a&&b.remove(c),c=c.next;return b},k={deliver:d,receive:l,dropMessages:g,retract:m},this.LinkedList=a,this.postman=k}).call(this)